# 収穫ロボT7 UI要件定義書

## 1. 概要

### 1.1 目的

収穫ロボT7の操作用タッチパネルUIの要件を定義し、栽培担当者が効率的かつ安全にロボットを操作できるシステムを実現する。

### 1.2 対象デバイス

- **メインデバイス**: タッチパネル（仕様確定済み）
- **サブデバイス**:
    - 緊急停止ボタン（物理ボタン）
    - パトライト（ロボット状態表示）
    - スピーカー（エラー通知音）

## 2. ユースケース

### 2.1 メインフロー

1. **ロボット移動**: 栽培担当者がロボットを開始地点まで運ぶ
2. **収穫設定**: 開始地点でUI操作により収穫パラメータを設定
3. **収穫実行**: 設定確認後、収穫作業を開始
4. **エラー対応**: エラー発生時の対応と復旧作業
5. **作業完了**: 収穫完了後の充電ステーションへの移動

### 2.2 詳細ユースケース

### 2.2.1 収穫設定フロー

- 開始レーンの選択（エリア名、畝名、東西方向）
- 収穫レーン数の設定
- 進行方向の選択（東進/西進）
- 収穫計画の移動軌跡確認
- 熟度しきい値の設定
- 目標収穫量の設定
- **準備確認**: 収穫カゴのセット状況、通路の障害物確認
- 準備確認完了後、収穫開始

### 2.2.2 エラー対応フロー

- エラー内容の表示・確認
- ユーザーによる復旧作業
- 作業再開/終了の選択

### 2.2.3 充電フロー

- 充電ステーションへの移動
- 充電開始

## 3. 表示情報要件

### 3.1 常時表示情報

- **バッテリー残量**: パーセンテージ表示、視覚的インジケータ
- **現在時刻**: 24時間表記
- **収穫開始からの経過時間**: HH:MM:SS形式

### 3.2 状況別表示情報

- **収穫計画の移動軌跡**: 地図形式での表示
- **現在の収穫量**: 数値とプログレスバー
- **エラー内容**: 詳細メッセージ、エラー分類（ユーザー対応可能/開発者対応必要）、対処方法
- **準備確認項目**: 収穫カゴ設置状況、通路障害物確認（目視確認）

### 3.3 外部デバイス表示

- **パトライト表示**: ロボット状態（待機中/収穫中/エラー中/充電中）
- **スピーカー通知**: エラー発生時の音声アラート、収穫中の安全通知音楽
- ※パトライト・スピーカーはUI制御対象外（ロボット制御システムが直接制御）

## 4. 入力機能要件

### 4.1 選択・設定機能

- **開始レーン選択**: ドロップダウンまたはリスト選択
- **進行方向選択**: 東進/西進のラジオボタン
- **レーン数設定**: 数値入力（スピナー形式）
- **熟度しきい値設定**: スライダーまたは数値入力
- **目標収穫量設定**: 数値入力

### 4.2 操作ボタン

- **開始ボタン**: 収穫作業開始（準備確認後に有効化）
- **再開ボタン**: エラー復旧後の作業再開
- **終了ボタン**: 作業終了
- **緊急停止ボタン**: UI上の緊急停止（物理ボタンと連動）
- **準備確認ボタン**: 収穫カゴ・通路確認完了

## 5. 画面構成要件

### 5.1 メイン画面

- ステータス表示エリア（バッテリー、時刻、経過時間）
- 作業進捗表示エリア（収穫量、軌跡）
- 操作ボタンエリア

### 5.2 設定画面

- 収穫パラメータ設定エリア
- 軌跡プレビューエリア
- 設定確認・実行エリア

### 5.4 準備確認画面

- 準備項目チェックリスト表示エリア
- 確認状況表示エリア
- 準備完了確認ボタンエリア
- エラー詳細表示エリア
- 対処方法表示エリア
- 操作選択エリア

## 6. UI/UX要件

### 6.1 操作性

- タッチ操作に適した大きなボタン（最小44px×44px）
- 直感的なアイコンとラベル
- 誤操作防止のための確認ダイアログ

### 6.2 視認性

- 屋外使用を考慮した高コントラスト表示
- 重要な情報の強調表示
- 色覚障害者への配慮

### 6.3 応答性

- タッチ操作への即座の反応
- 処理中の明確な進捗表示
- エラー時の迅速な通知

## 7. 技術要件

### 7.1 パフォーマンス

- 画面遷移時間：1秒以内
- タッチ応答時間：0.1秒以内
- データ更新頻度：1秒間隔

### 7.2 互換性

- ロボット制御システムとの通信仕様
- センサーデータの取得・表示
- ログ記録機能

## 8. 安全性要件

### 8.1 緊急停止機能

- UI上の緊急停止ボタンと物理緊急停止ボタンの連動
- 任意の画面から即座にアクセス可能
- 緊急停止時のパトライト・スピーカー連動

### 8.2 エラー処理

- エラー分類による対応レベル表示
    - **ユーザー対応可能**: 作業者が現場で復旧可能なエラー
    - **開発者対応必要**: 専門技術者の対応が必要なエラー
- 全てのエラーの適切な表示とスピーカー通知
- 安全な復旧手順の提示（ユーザー対応可能エラーのみ）
- 危険な操作の防止

### 8.3 準備確認機能

- 収穫開始前の必須確認項目（目視確認）
    - 空の収穫カゴの設置確認
    - 通路の障害物確認
- 全項目確認完了まで開始ボタン無効化

## 9. パトライト状態表示要件

### 9.1 状態別表示

- **待機中**: 緑色点灯
- **収穫中**: 青色点滅
- **エラー中**: 赤色点滅
- **充電中**: 黄色点灯
- **緊急停止**: 赤色点灯

### 9.2 スピーカー通知要件

- **エラー発生**: 注意喚起音（エラー対応レベルに応じた音量・パターン）
- **緊急停止**: 緊急アラート音
- **作業完了**: 完了通知音
- **収穫中安全通知**: 音楽再生による周囲作業者への衝突注意喚起

## 10. 画面遷移フロー

### 10.1 標準フロー

1. **初期画面** → 設定入力
2. **設定画面** → 軌跡確認
3. **軌跡確認画面** → 準備確認
4. **準備確認画面** → 収穫開始
5. **収穫中画面** → 作業完了/エラー

### 10.2 エラー発生時フロー

- 任意の画面 → **エラー画面** → 復旧後再開/終了選択

## 11. 今後の検討事項

### 11.1 エラー分類の詳細定義

- **ユーザー対応可能エラー**
    - 例：収穫カゴ満杯、軽微な障害物検知、バッテリー低下警告
    - 復旧手順をUI上に表示
    - ユーザー復旧後の再開操作が可能
- **開発者対応必要エラー**
    - 例：システムエラー、センサー故障、通信エラー
    - 開発者・技術者への連絡が必要な旨を表示
    - 安全な停止状態を維持

### 11.2 準備確認項目の詳細

- **収穫カゴ確認**: 空のカゴが正しい位置に設置されているか（目視）
- **通路確認**: 移動経路上に障害物がないか（目視）
- 確認項目はチェックボックス形式で順次確認
- 全項目確認完了まで開始ボタンは非活性状態

### 11.3 音響システム要件

- **収穫中安全通知**:
    - 音楽または警告音による周囲への注意喚起
    - 音量・音種の設定は不要（固定仕様）
    - UIでの制御は不要（自動的に収穫開始と連動）

---

*この要件定義書は初版であり、詳細な仕様確認後に更新される予定です。*